# Please report bugs regarding the PKGBUILD at
# https://github.com/ystein/archlinux-aur

# Maintainer: Yannik Stein <yannik.stein [at] gmail.com>

pkgname=rhythmbox-tray-icon-git
pkgver=20121002
pkgrel=1
pkgdesc="Restores the tray icon functionality from the 0.x series. Please \
report bugs regarding the PKGBUILD at https://github.com/ystein/archlinux-aur."

arch=('any')
url="http://github.com/palfrey/rhythmbox-tray-icon"
license=('GPL3')
conflicts=('rhythmbox-tray-icon')
depends=('rhythmbox>=2.90' 'python-cairo' 'gnome-icon-theme')
makedepends=('git')

_gitroot="git://github.com/palfrey/rhythmbox-tray-icon.git"
_gitname="rhythmbox-tray-icon"

build() {
    cd "$srcdir"

    msg2 "Connecting to GIT server..."
    if [[ -d "$_gitname" ]]; then
        cd "$_gitname"
        git reset --hard
        git pull
        msg2 "The local files are updated."
    else
        git clone "$_gitroot" "$_gitname"
    fi
    msg2 "GIT checkout done or server timeout."
}

package() {
    cd "$_gitname"
    while read instruction; do
        file=$(echo $instruction | awk '{ print $1 }')
        dest=$(echo $instruction | awk '{ print $2 }')
        install -D -m644 "$file" "$pkgdir/$dest/$file"
    done < "debian/install"
}

